# SBSEC-08.02 Audit Chain Verification and Checkpoints


## 1. Purpose

Defines verification for the tamper-evident audit chain, checkpointing, and optional signatures.

## 2. Chain Construction

For each event N:
- include `prev_event_hash = event_hash(N-1)` in event N
- compute `event_hash(N)`

Genesis event uses a fixed `prev_event_hash = 32 bytes of 0x00`.

## 3. Checkpoints

A checkpoint is an audit record containing:
- `checkpoint_index`
- `last_event_hash`
- optional signature by node/cluster key
- timestamp

Checkpoint interval is configuration; Level 4+ SHOULD use periodic checkpoints.

## 4. Verification Algorithm

To verify a chain segment:
1. Decode each event with SBSEC-08.01 rules.
2. Recompute each event_hash.
3. Verify the `prev_event_hash` links.
4. If checkpoints exist, verify checkpoint signatures and that `last_event_hash` matches.

## 5. Optional Signatures

At higher levels, events or checkpoints MAY include signatures. If used, the signature MUST cover:
- the event_hash (or checkpoint last_event_hash),
- the signer identity,
- a signature version.

