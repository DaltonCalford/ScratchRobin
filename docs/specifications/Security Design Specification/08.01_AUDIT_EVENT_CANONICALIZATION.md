# SBSEC-08.01 Audit Event Canonicalization


## 1. Purpose

Defines the canonical encoding used for audit event hashing and chain construction.

## 2. Canonical Encoding (TLV)

Audit events MUST be encoded as TLV using these rules:
- tags sorted ascending,
- integers unsigned big-endian minimal,
- strings UTF-8 NFC,
- UUIDs raw 16 bytes,
- no floats,
- timestamps unix seconds or unix nanos (fixed per event version).

## 3. Required Fields (V1)

- 0x01 event_id (UUIDv7)
- 0x02 event_type (u16)
- 0x03 timestamp (u64)
- 0x04 principal_id (UUID) optional for system events
- 0x05 session_id (UUID) optional
- 0x06 database_id (UUID) optional
- 0x07 object_ids (repeated UUID) optional
- 0x08 decision (u16) optional
- 0x09 details (nested TLV) optional
- 0x0A prev_event_hash (32 bytes) required except genesis
- 0x0B version (u16)=1

## 4. Event Hash

`event_hash = SHA-256(TLV_bytes)`

